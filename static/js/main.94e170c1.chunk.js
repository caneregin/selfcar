(this.webpackJsonpselfcar=this.webpackJsonpselfcar||[]).push([[0],{10:function(e,t,n){e.exports=n(20)},15:function(e,t,n){},16:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},17:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(9),i=n.n(r),s=(n(15),n(1)),c=n(2),l=n(3),u=n(4),h=(n(16),n(17),n(6)),d=n.n(h),f=n(7),p=n(5),m=function e(){Object(s.a)(this,e),this.learningRate=.3;var t=new p.Layer(2),n=new p.Layer(10),a=new p.Layer(2);t.project(n),n.project(a),this.nn=new p.Network({input:t,hidden:[n],output:a})},g=function(e){return e*Math.PI/180},v=function e(){var t=this;Object(s.a)(this,e),this.maxDistance=100,this.foundX=0,this.foundY=0,this.findIntersection=function(e,n,a,o,r,i,s){Math.sqrt(Math.pow(a-r,2)+Math.pow(o-i,2));if(e>t.maxDistance)return!1;var c=n[640*Math.floor(o)+Math.floor(a)];return c&&0!==c[0]?t.findIntersection(e+1,n,a+1*Math.cos(g(s)),o+1*Math.sin(g(s)),r,i,s):[a,o]},this.getValue=function(e,n,a,o){var r=n+t.maxDistance*Math.cos(g(o))+20,i=a+t.maxDistance*Math.sin(g(o))+12.5;if(e){var s=t.findIntersection(0,e,n,a,r,i,o),c=s||[r,i],l=Object(f.a)(c,2),u=l[0],h=l[1];return t.foundX=u,t.foundY=h,Math.min(1,Math.sqrt(Math.pow(n-u,2)+Math.pow(a-h,2))/t.maxDistance)}return 0}},w=0,y=function(){function e(){var t=this;Object(s.a)(this,e),this.speedUp=function(){},this.speedDown=function(){},this.steerLeft=function(){t.angle=(t.angle-4)%360},this.steerRight=function(){t.angle=(t.angle+4)%360},this.update=function(e,n){t.x+=t.speed*Math.cos(g(t.angle)),t.y+=t.speed*Math.sin(g(t.angle));var a=t.collectSensorData(n);0===a[0]&&(console.log("dead"),t.reset());var o=e.nn.activate([a,t.angle]),r=Object(f.a)(o,2),i=r[0]>r[1];i?t.steerLeft():t.steerRight();var s=t.collectSensorData(n);1===s[0]?e.nn.propagate(.3,[.5,.5]):s[0]<a[0]&&e.nn.propagate(.2,i?[0,1]:[1,0])},this.collectSensorData=function(e){return t.sensors.map((function(n){return n.getValue(e,t.x,t.y,t.angle)}))},this.reset(),this.id=w++}return Object(c.a)(e,[{key:"reset",value:function(){this.start=Date.now(),this.x=80,this.y=100,this.width=40,this.height=25,this.angle=0,this.sensors=[new v],this.speed=2,this.maxSpeed=3,this.acc=.5}}]),e}();function x(e){for(var t=[],n=0;n<100;n++)t.push(new y);var a,o,r,i=new m;e.setup=function(){o=e.createCanvas(640,480),e.noStroke(),e.background(255),a=JSON.parse(window.localStorage.getItem("map"));var t=e.get(0,0,640,480);t.loadPixels();for(var n=0;n<t.pixels.length;n+=4){var i=Math.floor(n/4);t.pixels[n]=a[i][0],t.pixels[n+1]=a[i][1],t.pixels[n+2]=a[i][2],t.pixels[n+3]=255}t.updatePixels(),r=t},e.mousePressed=function(){console.log(e.get(e.mouseX,e.mouseY))},e.draw=function(){e.update(),e.background(255),r&&e.image(r,0,0,640,480);var n=t[0];e.rectMode(e.CENTER),e.translate(n.x,n.y),e.angleMode(e.DEGREES),e.rotate(n.angle),e.fill(150,100,200),e.rect(0,0,n.width,n.height),e.fill(150,150,150),e.rect(10,0,10,15),e.fill("black"),e.rect(25,-8.5,4,6),e.rect(25,8.5,4,6),e.stroke("red"),n.sensors.map((function(t){var a=t.maxDistance*Math.cos(g(n.angle)),o=t.maxDistance*Math.sin(g(n.angle));e.rotate(-n.angle),e.line(0,0,a,o),e.rect(t.foundX-n.x,t.foundY-n.y,15,15)})),e.stroke(0)},e.update=function(){t.forEach((function(e){return e.update(i,a)}))},e.myCustomRedrawAccordingToNewPropsHandler=function(t){o&&e.fill(t.color)},e.keyPressed=function(){e.keyCode}}var k=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{style:{width:"100%",height:"100%"}},o.a.createElement("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},o.a.createElement(d.a,{sketch:x,color:"red"})))}}]),n}(o.a.Component);function b(e){var t;e.setup=function(){e.createImage(640,480),t=e.createCanvas(640,480),e.noStroke(),e.background(255)},e.mousePressed=function(){console.log(e.get(e.mouseX,e.mouseY))},e.draw=function(){e.fill("black"),e.noStroke(0),!0===e.mouseIsPressed&&e.ellipse(e.mouseX,e.mouseY,40,40)},e.myCustomRedrawAccordingToNewPropsHandler=function(n){t&&e.fill(n.color)},e.keyPressed=function(){if(83===e.keyCode){console.log("z");var t=e.get(0,0,640,480);t.loadPixels();for(var n=[],a=0;a<t.pixels.length;a+=4){var o=t.pixels[a],r=t.pixels[a+1],i=t.pixels[a+2];n.push([o,r,i])}console.log("saved"),window.localStorage.setItem("map",JSON.stringify(n))}}}var M=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{style:{width:"100%",height:"100%"}},o.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},o.a.createElement(d.a,{sketch:b,color:"red"})))}}]),n}(o.a.Component),j=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={mode:"game"},e.onGameClick=function(){e.setState({mode:"game"})},e.onDrawMapClick=function(){e.setState({mode:"draw"})},e}return Object(c.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{style:{width:"100%",height:"100%"}},o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("div",{onClick:this.onGameClick,style:{display:"flex",justifyContent:"center",alignItems:"center",width:"50%",height:"40px",color:"white"}},"Game"),o.a.createElement("div",{onClick:this.onDrawMapClick,style:{display:"flex",justifyContent:"center",alignItems:"center",width:"50%",height:"40px",color:"white"}},"Draw Map")),"game"===this.state.mode?o.a.createElement(k,null):o.a.createElement(M,null))}}]),n}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[10,1,2]]]);
//# sourceMappingURL=main.94e170c1.chunk.js.map